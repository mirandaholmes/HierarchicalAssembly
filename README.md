# HierarchicalAssembly

This code is made available to reproduce some of the simulations in the following paper, by Miranda Holmes-Cerfon and Mathhieu Wyart: 

* Holmes-Cerfon, M. and Wyart, M., 2025. Hierarchical self-assembly for high-yield addressable complexity at fixed conditions.  [arXiv:2501.02611](https://arxiv.org/abs/2501.02611).

The code simulates systems of sticky squares on a square lattice with "hierarchically" chosen interactions, using the Virtual Move Monte Carlo algorithm. The code is adapted from the code in [http://vmmc.xyz/](http://vmmc.xyz/), by adding the class `StickySquares` and by suitably modifying the source code to handle particles on a lattice.


## Running the code

* Make sure you have a c++ compiler installed. Change the corresponding line in the makefile to the name of your compiler (right now it is set up for `g++`).
* Create a sub-directory called `obj`. This is where the compiled source code is stored.
* Type `make`, to compile the code.
  - currently `make` is set up to compile `run_hier.cpp`. You can change the comment in the makefile to compile the other driver file.
* Run code as `./run_hier input_hier.txt 8.0` where 8.0 is some example energy level.
* Visualize output in Matlab using `plot_stickysquares.m`.

## Contents of repository

* `makefile`: to compile all the source code. Type `make`, in the same directory as the code. Make sure you have a c++ compiler installed. The makefile compiles all object files into a subdirectory called `obj`, so make sure you have this directory created.
* `run_hier.cpp` : main driver for simulations. Run as `./run_hier inputfile.txt del`, where `inputfile.txt` is the input file,  and `del` is the strongest energy. An example inputfile called `input_hier.txt` is given in this directory. 
* `run_crosstalk.cpp` : main driver for simulations with crosstalk. Same as above, but run as `./run_hier inputfile.txt del c` where `c` is the crosstalk energy (the interaction energy between neighbouring squares in non-native positions). An example input file is given as `input_crosstalk.txt`.
* `src` : directory containing the remaining source code.
* `plot_stickysquares.m` : Matlab script to visualize the output of the simulation. This is set up to visualize contents fo files `hier_traj.txt` and `crosstalk_traj.txt` immediately.
* `input_hier.txt`, `input_crosstalk.txt` : example input files, for `run_hier.cpp` and `run_crosstalk.cpp` respectively.
* `hier_traj.txt`, `hier_stats.txt`, `crosstalk_traj.txt`, `crosstalk_stats.txt` : output files generated by the above input files on their respective programs. 


